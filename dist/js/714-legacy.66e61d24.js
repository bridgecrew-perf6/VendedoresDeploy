"use strict";(self["webpackChunkvendedores"]=self["webpackChunkvendedores"]||[]).push([[714],{6640:function(e,r,t){t.d(r,{yo:function(){return i},if:function(){return u}});var n=t(4367),s=t(6198),a=(t(1703),t(5666),t(1618)),o=t(5321),c=t(7376);function i(e){return l.apply(this,arguments)}function l(){return l=(0,s.Z)(regeneratorRuntime.mark((function e(r){var t,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("current race user mutation"),t=(0,o.JU)(a.ZP,"/users",""+c.Z.state.common.currentUser.id),e.next=4,(0,o.r7)(t,{raceUser:r});case 4:return n=(0,o.JU)(a.ZP,"/users",""+r),e.next=7,(0,o.QT)(n);case 7:return s=e.sent.data(),s.sellers||(s.sellers={}),s.sellers[c.Z.state.common.currentUser.id]||(s.sellers[c.Z.state.common.currentUser.id]={score:0,proposals:0}),console.log(r," user info will be updated"),console.log({userInfo:s}),e.next=14,(0,o.r7)(n,{raceUser:r,sellers:s.sellers});case 14:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function u(e,r){return d.apply(this,arguments)}function d(){return d=(0,s.Z)(regeneratorRuntime.mark((function e(r,t){var s,i,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log({selectionIndex:r,pict:t}),s=c.Z.state.common.currentUser.id,i=(0,o.JU)(a.ZP,"/users",""+c.Z.state.common.currentUser.raceUser),l=c.Z.state.seller.currentRace,l[r].pictures||(l[r].pictures={}),l[r].pictLinks||(l[r].pictLinks={}),!l[r].pictLinks[t.original]){e.next=8;break}throw new Error("Alreaady taken");case 8:return u=1,d=l[r].pictures[s],d&&(delete l[r].pictLinks[d.original],u=0),l[r].pictures[s]=t,l[r].pictLinks[t.original]=t,console.log({newRaceInfo:l}),p=c.Z.state.seller.currentRaceUserInfo,p.sellers||(p.sellers={}),p.sellers[c.Z.state.common.currentUser.id]?p.sellers[c.Z.state.common.currentUser.id].proposals+=u:p.sellers[c.Z.state.common.currentUser.id]={proposals:u,score:0},e.next=19,(0,o.r7)(i,(0,n.Z)((0,n.Z)({},p),{},{race:l}));case 19:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}},5202:function(e,r,t){t.r(r),t.d(r,{default:function(){return b}});var n=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("v-container",{attrs:{dark:!1,value:!0}},[t("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{title:"Select a race to engage with",headers:e.headers,items:e.users2render,loading:e.loading,"fixed-header":"",dense:"","single-select":""},on:{"click:row":e.engage}},[t("template",{slot:"top"},[t("v-toolbar-title",{staticStyle:{padding:"20px","text-align":"center"}},[e._v(" Select a race to engage with ")])],1)],2)],1)},s=[],a=t(6198),o=t(4367),c=(t(5666),t(1249),t(7327),t(1539),t(9720),t(8309),t(1618)),i=t(5321),l=t(6640),u=t(629),d={data:function(){return{loading:!0,users:[],snapshootUnsubscribe:null,headers:[{text:"User name",value:"name"},{text:"Sellers engaged",value:"sellers",align:"start"},{text:"Ongoing quiz ",value:"ongoingQuiz",align:"start"},{text:"Total quiz ",value:"race.length",align:"start"}]}},created:function(){var e=this;this.snapshootRef=(0,i.cf)((0,i.hJ)(c.ZP,"users"),(function(r){e.loading=!1,r.docChanges().map((function(r){var t=(0,o.Z)((0,o.Z)({},r.doc.data()),{},{name:r.doc.id});"added"===r.type&&(console.log("added",t),e.users.push(t)),"modified"===r.type&&console.log("modified",t),"deleted"===r.type&&console.log("deleted",r.doc.data())}))}))},beforeDestroy:function(){"function"===typeof this.snapshootUnsubscribe&&this.snapshootUnsubscribe()},computed:{users2render:function(){return this.users.filter((function(e){return"user"===e.type&&Array.isArray(e.race)&&!e.raceDone})).map((function(e){var r=e.race.filter((function(e){return!e.selected})).length;return(0,o.Z)((0,o.Z)({},e),{},{sellers:e.sellers&&Object.entries(e.sellers).length,ongoingQuiz:r})}))}},methods:(0,o.Z)((0,o.Z)({},(0,u.nv)("common",["updateCurrentUser"])),{},{engage:function(e){var r=this;return(0,a.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,(0,l.yo)(e.name);case 3:r.updateCurrentUser({raceUser:e.name}),"function"===typeof r.snapshootUnsubscribe&&r.snapshootUnsubscribe(),r.$toast.success("You are engaged to ".concat(e.name,"'s race now")),r.$router.push("/seller"),t.next=12;break;case 9:t.prev=9,t.t0=t["catch"](0),r.$toast.error(t.t0.message);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})))()}})},p=d,g=t(1001),f=t(3453),m=t.n(f),h=t(9846),Z=t(6310),v=t(7921),U=(0,g.Z)(p,n,s,!1,null,null,null),b=U.exports;m()(U,{VContainer:h.Z,VDataTable:Z.Z,VToolbarTitle:v.qW})}}]);
//# sourceMappingURL=714-legacy.66e61d24.js.map