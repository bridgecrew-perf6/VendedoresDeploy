"use strict";(self["webpackChunkvendedores"]=self["webpackChunkvendedores"]||[]).push([[833],{6640:function(e,t,r){r.d(t,{yo:function(){return i},if:function(){return u}});var n=r(4367),s=r(6198),a=(r(1703),r(5666),r(1618)),o=r(5321),c=r(7376);function i(e){return l.apply(this,arguments)}function l(){return l=(0,s.Z)(regeneratorRuntime.mark((function e(t){var r,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("current race user mutation"),r=(0,o.JU)(a.ZP,"/users",""+c.Z.state.common.currentUser.id),e.next=4,(0,o.r7)(r,{raceUser:t});case 4:return n=(0,o.JU)(a.ZP,"/users",""+t),e.next=7,(0,o.QT)(n);case 7:return s=e.sent.data(),s.sellers||(s.sellers={}),s.sellers[c.Z.state.common.currentUser.id]||(s.sellers[c.Z.state.common.currentUser.id]={score:0,proposals:0}),console.log(t," user info will be updated"),console.log({userInfo:s}),e.next=14,(0,o.r7)(n,{raceUser:t,sellers:s.sellers});case 14:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function u(e,t){return d.apply(this,arguments)}function d(){return d=(0,s.Z)(regeneratorRuntime.mark((function e(t,r){var s,i,l,u,d,p;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(console.log({selectionIndex:t,pict:r}),s=c.Z.state.common.currentUser.id,i=(0,o.JU)(a.ZP,"/users",""+c.Z.state.common.currentUser.raceUser),l=c.Z.state.seller.currentRace,l[t].pictures||(l[t].pictures={}),l[t].pictLinks||(l[t].pictLinks={}),!l[t].pictLinks[r.original]){e.next=8;break}throw new Error("Alreaady taken");case 8:return u=1,d=l[t].pictures[s],d&&(delete l[t].pictLinks[d.original],u=0),l[t].pictures[s]=r,l[t].pictLinks[r.original]=r,console.log({newRaceInfo:l}),p=c.Z.state.seller.currentRaceUserInfo,p.sellers||(p.sellers={}),p.sellers[c.Z.state.common.currentUser.id]?p.sellers[c.Z.state.common.currentUser.id].proposals+=u:p.sellers[c.Z.state.common.currentUser.id]={proposals:u,score:0},e.next=19,(0,o.r7)(i,(0,n.Z)((0,n.Z)({},p),{},{race:l}));case 19:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}},3445:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{attrs:{dark:!1,value:!0}},[r("v-data-table",{staticClass:"elevation-1",staticStyle:{cursor:"pointer"},attrs:{title:"Select a race to engage with",headers:e.headers,items:e.users2render,loading:e.loading,"fixed-header":"",dense:"","single-select":"","no-data-text":"No user is hosting a race right now"},on:{"click:row":e.engage}},[r("template",{slot:"top"},[r("v-toolbar-title",{staticStyle:{padding:"20px","text-align":"center"}},[e._v(" Select a race to engage with ")])],1)],2)],1)},s=[],a=r(6198),o=r(4367),c=(r(5666),r(1249),r(7327),r(1539),r(9720),r(8309),r(1618)),i=r(5321),l=r(6640),u=r(629),d={data:function(){return{loading:!0,users:[],snapshootUnsubscribe:null,headers:[{text:"User name",value:"name"},{text:"Sellers engaged",value:"sellers",align:"start"},{text:"Ongoing quiz ",value:"ongoingQuiz",align:"start"},{text:"Total quiz ",value:"race.length",align:"start"}]}},created:function(){var e=this;this.snapshootRef=(0,i.cf)((0,i.hJ)(c.ZP,"users"),(function(t){e.loading=!1,t.docChanges().map((function(t){var r=(0,o.Z)((0,o.Z)({},t.doc.data()),{},{name:t.doc.id});"added"===t.type&&(console.log("added",r),e.users.push(r)),"modified"===t.type&&console.log("modified",r),"deleted"===t.type&&console.log("deleted",t.doc.data())}))}))},beforeDestroy:function(){"function"===typeof this.snapshootUnsubscribe&&this.snapshootUnsubscribe()},computed:{users2render:function(){return this.users.filter((function(e){return"user"===e.type&&Array.isArray(e.race)&&!e.raceDone})).map((function(e){var t=e.race.filter((function(e){return!e.selected})).length;return(0,o.Z)((0,o.Z)({},e),{},{sellers:e.sellers&&Object.entries(e.sellers).length,ongoingQuiz:t})}))}},methods:(0,o.Z)((0,o.Z)({},(0,u.nv)("common",["updateCurrentUser"])),{},{engage:function(e){var t=this;return(0,a.Z)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,(0,l.yo)(e.name);case 3:t.updateCurrentUser({raceUser:e.name}),"function"===typeof t.snapshootUnsubscribe&&t.snapshootUnsubscribe(),t.$toast.success("You are engaged to ".concat(e.name,"'s race now")),t.$router.push("/seller"),r.next=12;break;case 9:r.prev=9,r.t0=r["catch"](0),t.$toast.error(r.t0.message);case 12:case"end":return r.stop()}}),r,null,[[0,9]])})))()}})},p=d,g=r(1001),f=r(3453),h=r.n(f),m=r(9846),Z=r(6310),v=r(7921),U=(0,g.Z)(p,n,s,!1,null,null,null),b=U.exports;h()(U,{VContainer:m.Z,VDataTable:Z.Z,VToolbarTitle:v.qW})}}]);
//# sourceMappingURL=833-legacy.41742273.js.map