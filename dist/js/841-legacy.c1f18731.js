"use strict";(self["webpackChunkvendedores"]=self["webpackChunkvendedores"]||[]).push([[841],{3237:function(e,t,r){r.d(t,{Z:function(){return o}});var n=r(4367),a=(r(9653),r(4944),r(3792),r(5648)),s=r(4981),c=r(6505),i=r(3325),o=(0,i.Z)(s.Z,c.Z,a.Z).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,link:Boolean,loaderHeight:{type:[Number,String],default:4},raised:Boolean},computed:{classes:function(){return(0,n.Z)((0,n.Z)({"v-card":!0},c.Z.options.computed.classes.call(this)),{},{"v-card--flat":this.flat,"v-card--hover":this.hover,"v-card--link":this.isClickable,"v-card--loading":this.loading,"v-card--disabled":this.disabled,"v-card--raised":this.raised},a.Z.options.computed.classes.call(this))},styles:function(){var e=(0,n.Z)({},a.Z.options.computed.styles.call(this));return this.img&&(e.background='url("'.concat(this.img,'") center center / cover no-repeat')),e}},methods:{genProgress:function(){var e=s.Z.options.methods.genProgress.call(this);return e?this.$createElement("div",{staticClass:"v-card__progress",key:"progress"},[e]):null}},render:function(e){var t=this.generateRouteLink(),r=t.tag,n=t.data;return n.style=this.styles,this.isClickable&&(n.attrs=n.attrs||{},n.attrs.tabindex=0),e(r,this.setBackgroundColor(this.color,n),[this.genProgress(),this.$slots.default])}})},7118:function(e,t,r){r.d(t,{h7:function(){return s},ZB:function(){return i},EB:function(){return o}});var n=r(3237),a=r(4589),s=(0,a.Ji)("v-card__actions"),c=(0,a.Ji)("v-card__subtitle"),i=(0,a.Ji)("v-card__text"),o=(0,a.Ji)("v-card__title");n.Z},634:function(e,t,r){r.d(t,{Z:function(){return u},w:function(){return o}});var n=r(6198),a=(r(5666),r(9669)),s=r.n(a),c=r(1485);r(9600);function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=new Date(e),r=""+(t.getMonth()+1),n=""+t.getDate(),a=t.getFullYear();return r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),[a,r,n].join("-")}function o(){return l.apply(this,arguments)}function l(){return l=(0,n.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,s().get(c.bo+"/sellers");case 2:return e.abrupt("return",e.sent.data);case 3:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}function u(e,t){return d.apply(this,arguments)}function d(){return d=(0,n.Z)(regeneratorRuntime.mark((function e(t,r){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log({quantity:t,seller:r}),n=Date.now(),e.next=4,s().post(c.bo+"/invoices",{date:i(n),dueDate:i(n+6912e5),client:1,items:[{id:1,price:1,quantity:t}],seller:r,status:"open"});case 4:return e.abrupt("return",e.sent.data);case 5:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}},4691:function(e,t,r){r.d(t,{Z:function(){return m}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-row",{attrs:{justify:"center"}},[r("v-dialog",{attrs:{persistent:"","max-width":"290"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},[r("v-card",[r("v-card-title",{staticClass:"text-h5"},[e._v(" "+e._s(e.title||"Confirm?")+" ")]),e.text?r("v-card-text",[e._v(e._s(e.text))]):e._e(),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{color:"secondary darken-1",text:""},on:{click:e.cancel}},[e._v(" "+e._s(e.cancelText||"cancel")+" ")]),r("v-btn",{attrs:{color:"primary darken-1",text:""},on:{click:e.accept}},[e._v(" "+e._s(e.okText||"ok")+" ")])],1)],1)],1)],1)},a=[],s={props:{title:String,text:String,okText:String,cancelText:String,value:Boolean},methods:{accept:function(){this.$emit("input",!1),this.$emit("accept",!0)},cancel:function(){this.$emit("input",!1)}}},c=s,i=r(1001),o=r(3453),l=r.n(o),u=r(3150),d=r(3237),v=r(7118),h=r(6662),f=r(2877),p=r(9762),g=(0,i.Z)(c,n,a,!1,null,null,null),m=g.exports;l()(g,{VBtn:u.Z,VCard:d.Z,VCardActions:v.h7,VCardText:v.ZB,VCardTitle:v.EB,VDialog:h.Z,VRow:f.Z,VSpacer:p.Z})},4841:function(e,t,r){r.r(t),r.d(t,{default:function(){return k}});var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",[r("v-row",{attrs:{"align-content":"center",justify:"center"}},[r("v-col",{staticClass:"text-subtitle-1 text-center",attrs:{cols:"12"}},[r("v-alert",{attrs:{type:"user"===e.currentUser.type?"info":e.winner?"success":"error",text:""}},[r("h2",{staticClass:"main-header",style:e.titleStyle},[e._v(e._s(e.title))]),r("div",{staticStyle:{"font-size":"small"}},[e._v(" Race finished at "+e._s(e.finishDate)+" ")])])],1)],1),r("v-row",{staticClass:"my-5",attrs:{"align-content":"center",justify:"center"}},[r("scores",{staticStyle:{"min-width":"98%","max-width":"700px"},attrs:{sellers:e.raceDone.sellers,myId:e.currentUser.id}})],1),"seller"===e.currentUser.type?r("v-row",{staticClass:"my-1",attrs:{"align-content":"center",justify:"center"}},[e.winner?r("div",{staticClass:"text-subtitle-1 text-center py-2",attrs:{cols:"12"}},[r("article",[e._v(" As the winer of the race you may now generate an "),r("a",{attrs:{href:"alegra.com"}},[e._v("Alegra")]),e._v(" invoice. Once it's done you can delete all your records of the race and start from scratch with another race if you want to ")])]):r("div",{staticClass:"text-subtitle-1 text-center py-2",attrs:{cols:"12"}},[r("article",[e._v(" You can delete all your records of the race and start from scratch with another race if you want to ")])])]):e._e(),e.winner?r("v-row",{staticClass:"my-2",attrs:{"align-content":"center",justify:"center",cols:"12"},on:{click:e.generateInvoice}},[r("v-btn",{attrs:{width:"200",disabled:e.raceDone.invoice}},[e.loadingInvoice?r("v-progress-circular",{attrs:{indeterminate:"",color:"primary",width:"2"}}):r("div",[e._v("generateInvoice")])],1)],1):e._e(),"seller"===e.currentUser.type?r("v-row",{staticClass:"my-2",attrs:{"align-content":"center",justify:"center"}},[r("v-btn",{attrs:{width:"200",disabled:e.winner&&!e.raceDone.invoice},on:{click:function(t){e.confirmDialog=!0}}},[e.loadingFromScratch?r("v-progress-circular",{attrs:{indeterminate:"",color:"primary",width:"2"}}):r("div",[e._v("Start from scratch")])],1)],1):e._e(),r("confirm-dialog",{attrs:{text:"You won't be able to see the information related to this race anymore"},on:{accept:e.resetSeller},model:{value:e.confirmDialog,callback:function(t){e.confirmDialog=t},expression:"confirmDialog"}}),e._v(" > ")],1)},a=[],s=r(6198),c=r(4367),i=(r(1703),r(5666),r(629)),o=r(9381),l=r(1618),u=r(634),d=r(4691),v={components:{Scores:o.Z,ConfirmDialog:d.Z},data:function(){return{loadingInvoice:!1,loadingFromScratch:!1,confirmDialog:!1}},computed:(0,c.Z)((0,c.Z)({},(0,i.rn)("common",["currentUser"])),{},{raceDone:function(){return this.currentUser.raceDone},winner:function(){return this.raceDone.winner===this.currentUser.id},title:function(){return this.winner?"Congrats, you Won":"Race has finished, ".concat(this.raceDone.winner," won")},finishDate:function(){return new Date(this.raceDone.timestamp).toLocaleString()},titleStyle:function(){return"user"===this.currentUser.type?"color:blue":this.winner?"color:green":"color:red"}}),methods:(0,c.Z)((0,c.Z)((0,c.Z)({},(0,i.nv)("common",["updateCurrentUser"])),(0,i.nv)(["resetState"])),{},{resetSeller:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("seller"===e.currentUser.type){t.next=2;break}return t.abrupt("return");case 2:return e.loadingFromScratch=!0,t.prev=3,r=e.currentUser,r.raceUser=null,r.raceDone=null,console.log({user:r},{id:e.currentUser.id}),t.next=10,(0,l.Nq)(e.currentUser.id,r);case 10:e.$router.push({path:"/"}),e.updateCurrentUser(r),e.resetState(),e.$toast.success("Done!, you can start from scratch now"),t.next=19;break;case 16:t.prev=16,t.t0=t["catch"](3),e.$toast.error(t.t0.message);case 19:return t.prev=19,e.loadingFromScratch=!1,t.finish(19);case 22:case"end":return t.stop()}}),t,null,[[3,16,19,22]])})))()},generateInvoice:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var r,n,a,s,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(n in e.loadingInvoice=!0,r=0,e.raceDone.sellers)Object.hasOwnProperty.call(e.raceDone.sellers,n)&&(a=e.raceDone.sellers[n],r+=a.score);if(t.prev=3,e.currentUser.alegraInfo){t.next=6;break}throw new Error("Account not linked to alegra");case 6:return t.next=8,(0,u.Z)(r,e.currentUser.alegraInfo);case 8:return s=t.sent,c=e.raceDone,c.invoice=s,e.updateCurrentUser({raceDone:c}),t.next=14,(0,l.Nq)(e.currentUser.raceUser,{raceDone:c});case 14:setTimeout((function(){return(0,l.Nq)(e.currentUser.id,{raceDone:c})})),e.$toast.success("Invoice created"),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](3),e.$toast.error(t.t0.message);case 21:return t.prev=21,e.loadingInvoice=!1,t.finish(21);case 24:case"end":return t.stop()}}),t,null,[[3,18,21,24]])})))()}})},h=v,f=r(1001),p=r(3453),g=r.n(p),m=r(5098),w=r(3150),y=r(2102),x=r(9846),Z=r(624),_=r(2877),b=(0,f.Z)(h,n,a,!1,null,null,null),k=b.exports;g()(b,{VAlert:m.Z,VBtn:w.Z,VCol:y.Z,VContainer:x.Z,VProgressCircular:Z.Z,VRow:_.Z})}}]);
//# sourceMappingURL=841-legacy.c1f18731.js.map